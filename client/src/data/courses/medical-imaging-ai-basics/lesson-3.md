# CNN（畳み込みニューラルネットワーク）の基礎

## このレッスンで学ぶこと

このレッスンを完了すると、CNN（畳み込みニューラルネットワーク）の基本構造を理解し、医療画像AIでどのように使用されているかを把握できるようになります。
画像認識の核心技術を学びます。

---

## セクション1: CNNとは何か

### CNNの定義

CNN（Convolutional Neural Network：畳み込みニューラルネットワーク）は、画像認識に特化した深層学習のアーキテクチャです。

特徴：
- 画像の特徴を自動的に学習
- 階層的に特徴を抽出
- 高い精度を実現

### なぜCNNが画像認識に適しているのか

従来のニューラルネットワークとの違い：

- **局所的な特徴の抽出**: 画像の局所的なパターンを認識
- **位置不変性**: 物体の位置が変わっても認識可能
- **パラメータの削減**: 全結合層よりパラメータが少ない
- **階層的な特徴学習**: 低レベルから高レベルまで特徴を学習

---

## セクション2: CNNの基本構造

### 畳み込み層（Convolutional Layer）

畳み込み層は、画像から特徴を抽出します。

仕組み：
- **フィルタ（カーネル）**: 小さな行列で画像を走査
- **特徴マップ**: フィルタの応答を記録
- **ストライド**: フィルタを移動する間隔
- **パディング**: 画像の端を処理

例：
- エッジ検出フィルタ
- ぼかしフィルタ
- シャープ化フィルタ

### プーリング層（Pooling Layer）

プーリング層は、特徴マップのサイズを縮小します。

目的：
- 計算量の削減
- 位置不変性の向上
- 過学習の防止

種類：
- **Max Pooling**: 最大値を選択
- **Average Pooling**: 平均値を計算

### 全結合層（Fully Connected Layer）

全結合層は、抽出された特徴から最終的な判断を行います。

役割：
- 特徴を統合
- 分類や回帰を実行

---

## セクション3: CNNの学習プロセス

### 順伝播（Forward Propagation）

画像を入力し、順番に各層を通して出力を得ます。

プロセス：
1. 画像の入力
2. 畳み込み層で特徴抽出
3. プーリング層でサイズ縮小
4. 全結合層で分類
5. 出力の生成

### 逆伝播（Backpropagation）

誤差を逆方向に伝播し、重みを更新します。

プロセス：
1. 出力と正解の誤差を計算
2. 誤差を逆方向に伝播
3. 各層の重みを更新
4. 学習を繰り返す

### 損失関数

モデルの性能を評価する関数です。

種類：
- **交差エントロピー誤差**: 分類タスクで使用
- **平均二乗誤差**: 回帰タスクで使用

---

## セクション4: 医療画像でのCNNの活用

### 例1: 胸部X線の異常検出

CNNを使用して胸部X線画像から異常を検出します。

構造：
- 入力層: 胸部X線画像
- 畳み込み層: 画像の特徴を抽出
- プーリング層: 特徴マップを縮小
- 全結合層: 異常の有無を判断
- 出力層: 異常の確率

### 例2: 眼底写真の解析

CNNを使用して眼底写真から糖尿病性網膜症を検出します。

特徴：
- 微細な病変を検出
- 高い精度を実現
- スクリーニングに活用

### 例3: 皮膚病変の診断

CNNを使用して皮膚の画像から悪性腫瘍を検出します。

効果：
- 診断精度の向上
- 早期発見の促進

---

## セクション5: CNNの限界と改善方法

### CNNの限界

CNNにも限界があります。

限界：
- **データの必要性**: 大量のデータが必要
- **計算リソース**: 高い計算リソースが必要
- **説明可能性**: 判断の根拠が不明確
- **汎化性能**: 新しいデータへの対応が困難

### 改善方法

#### 転移学習

事前学習されたモデルを活用します。

- ImageNetで学習したモデルを使用
- 医療画像でFine-tuning
- データ量を削減

#### データ拡張

データセットを拡大します。

- 画像の変換
- データの多様性を確保

#### アンサンブル

複数のモデルを組み合わせます。

- 複数のモデルの結果を統合
- 精度の向上

---

## まとめ：CNNの基礎を理解する

このレッスンでは、CNNの基本構造と学習プロセスを学びました。

重要なポイント：
1. CNNは画像認識に特化した深層学習のアーキテクチャ
2. 畳み込み層、プーリング層、全結合層で構成される
3. 医療画像AIで広く使用されている
4. 転移学習やデータ拡張により性能を向上できる

### 次のステップ

次のレッスンでは、転移学習について詳しく学びます。

---

更新日: 2025年12月

