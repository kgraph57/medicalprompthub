# 画像前処理の基礎

## このレッスンで学ぶこと

このレッスンを完了すると、医療画像の前処理方法を理解し、AIモデルに適した画像を準備できるようになります。
画像の品質を向上させ、AIの性能を最大限に引き出す方法を学びます。

---

## セクション1: なぜ画像前処理が必要か

### 画像前処理の目的

画像前処理とは、AIモデルに画像を投入する前に、画像を整理・変換・改善するプロセスです。

目的：
- 画像の品質を向上させる
- AIモデルの性能を向上させる
- データの一貫性を確保する

### 医療画像の課題

医療画像には、以下の課題があります：

- **ノイズ**: 画像にノイズが含まれる
- **コントラスト**: コントラストが不十分
- **解像度**: 解像度が異なる
- **アーティファクト**: 画像にアーティファクトが含まれる

前処理により、これらの課題を解決します。

---

## セクション2: 基本的な前処理手法

### リサイズ

画像のサイズを統一します。

目的：
- モデルへの入力サイズを統一
- 計算効率の向上

方法：
- 固定サイズにリサイズ
- アスペクト比を保持
- 補間方法を選択

### 正規化

ピクセル値を0-1の範囲に変換します。

目的：
- データのスケールを統一
- 学習の安定化

方法：
- Min-Max正規化
- ピクセル値を255で割る

### コントラスト調整

画像のコントラストを改善します。

方法：
- ヒストグラム均等化
- コントラストストレッチ
- CLAHE（適応的ヒストグラム均等化）

---

## セクション3: ノイズ除去

### ノイズの種類

医療画像には、様々なノイズが含まれます。

種類：
- **ガウシアンノイズ**: ランダムなノイズ
- **ソルト&ペッパーノイズ**: 白黒の点状ノイズ
- **量子化ノイズ**: デジタル化によるノイズ

### ノイズ除去の方法

#### ガウシアンフィルタ

ガウシアンフィルタでノイズを除去します。

- 平滑化効果
- エッジがぼける可能性

#### メディアンフィルタ

メディアンフィルタでノイズを除去します。

- ソルト&ペッパーノイズに有効
- エッジを保持

#### バイラテラルフィルタ

バイラテラルフィルタでノイズを除去します。

- エッジを保持しながらノイズを除去
- 計算コストが高い

---

## セクション4: データ拡張

### データ拡張とは

データ拡張とは、既存の画像を変換して、データセットを増やす手法です。

目的：
- データセットの拡大
- 過学習の防止
- モデルの汎化性能の向上

### データ拡張の方法

#### 幾何変換

- **回転**: 画像を回転
- **反転**: 画像を左右/上下反転
- **スケーリング**: 画像を拡大/縮小
- **平行移動**: 画像を移動

#### 色変換

- **明度調整**: 明るさを変更
- **コントラスト調整**: コントラストを変更
- **色相調整**: 色相を変更

#### 医療画像での注意点

医療画像では、以下の点に注意が必要です：

- **解剖学的妥当性**: 変換が解剖学的に妥当か
- **診断への影響**: 変換が診断に影響しないか
- **専門家の確認**: 専門家の意見を聞く

---

## セクション5: 実践例

### 例1: 胸部X線画像の前処理

胸部X線画像の前処理手順：

1. **リサイズ**: 512×512ピクセルに統一
2. **正規化**: ピクセル値を0-1に変換
3. **コントラスト調整**: CLAHEを適用
4. **ノイズ除去**: 必要に応じてフィルタを適用

### 例2: CT画像の前処理

CT画像の前処理手順：

1. **ウィンドウ調整**: 適切なウィンドウ幅・レベルを設定
2. **リサイズ**: モデルの入力サイズに統一
3. **正規化**: ピクセル値を0-1に変換
4. **スライス選択**: 重要なスライスを選択

---

## まとめ：画像前処理の基礎を理解する

このレッスンでは、医療画像の前処理方法を学びました。

重要なポイント：
1. 画像前処理はAIモデルの性能に大きな影響を与える
2. 基本的な前処理にはリサイズ、正規化、コントラスト調整がある
3. ノイズ除去により画像の品質を向上させる
4. データ拡張によりデータセットを拡大し、過学習を防止する

### 次のステップ

次のレッスンでは、CNN（畳み込みニューラルネットワーク）について詳しく学びます。

---

更新日: 2025年12月

