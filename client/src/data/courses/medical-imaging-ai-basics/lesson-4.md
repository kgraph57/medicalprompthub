# 転移学習の活用

## このレッスンで学ぶこと

このレッスンを完了すると、転移学習の概念を理解し、医療画像AIで転移学習を効果的に活用できるようになります。
限られたデータで高性能なモデルを構築する方法を学びます。

---

## セクション1: 転移学習とは何か

### 転移学習の定義

転移学習とは、あるタスクで学習した知識を、別のタスクに転移して活用する手法です。

医療画像AIでの例：
- ImageNetで学習したモデルを医療画像に適用
- 一般画像で学習した特徴を医療画像で活用

### なぜ転移学習が重要なのか

医療画像AIの課題：

- **データの不足**: 医療画像データは限られている
- **アノテーションのコスト**: 専門家によるアノテーションが必要
- **計算リソース**: ゼロから学習するには時間がかかる

転移学習により、これらの課題を解決できます。

---

## セクション2: 転移学習の方法

### 方法1: 特徴抽出（Feature Extraction）

事前学習されたモデルの特徴抽出部分のみを使用します。

手順：
1. 事前学習モデルを読み込む
2. 最後の全結合層を削除
3. 特徴抽出部分を固定
4. 新しい分類層を追加
5. 新しい分類層のみを学習

メリット：
- 学習が高速
- データが少なくても学習可能

### 方法2: Fine-tuning

事前学習されたモデルの重みを初期値として、全体を再学習します。

手順：
1. 事前学習モデルを読み込む
2. 最後の分類層を新しいタスク用に変更
3. 初期の層は学習率を低く設定
4. 後半の層は学習率を高く設定
5. 全体を学習

メリット：
- より高い性能が期待できる
- タスクに特化した特徴を学習

---

## セクション3: 事前学習モデル

### ImageNetで学習したモデル

ImageNetは、1400万枚以上の画像を含む大規模なデータセットです。

主要なモデル：
- **VGG**: シンプルな構造
- **ResNet**: 残差接続を使用
- **Inception**: 複数のフィルタサイズを使用
- **EfficientNet**: 効率的な構造

### 医療画像への適用

ImageNetで学習したモデルを医療画像に適用します。

理由：
- 低レベルの特徴（エッジ、テクスチャ）は共通
- 高レベルの特徴は医療画像で再学習

---

## セクション4: 実践例

### 例1: 胸部X線の異常検出

転移学習を使用して胸部X線の異常検出モデルを構築します。

手順：
1. ImageNetで学習したResNetを読み込む
2. 最後の分類層を2クラス分類用に変更
3. 胸部X線データでFine-tuning
4. 性能を評価

効果：
- データが少なくても高い性能
- 学習時間の短縮

### 例2: 眼底写真の解析

転移学習を使用して眼底写真の解析モデルを構築します。

手順：
1. ImageNetで学習したEfficientNetを読み込む
2. 特徴抽出部分を固定
3. 新しい分類層を追加
4. 眼底写真データで学習

効果：
- 限られたデータで学習可能
- 高い精度を実現

---

## セクション5: ベストプラクティス

### 原則1: データ量に応じて方法を選択

- **データが少ない場合**: 特徴抽出
- **データが多い場合**: Fine-tuning

### 原則2: 学習率を調整する

- **初期の層**: 低い学習率（0.0001など）
- **後半の層**: 高い学習率（0.001など）

### 原則3: データ拡張を活用する

転移学習と組み合わせてデータ拡張を実施します。

- 画像の変換
- データの多様性を確保

### 原則4: 複数のモデルを試す

複数の事前学習モデルを試し、最適なものを選択します。

- VGG、ResNet、EfficientNetなどを比較
- 性能と計算コストを考慮

---

## まとめ：転移学習の活用を理解する

このレッスンでは、転移学習の概念と実践方法を学びました。

重要なポイント：
1. 転移学習は限られたデータで高性能なモデルを構築できる
2. 特徴抽出とFine-tuningの2つの方法がある
3. ImageNetで学習したモデルを医療画像に適用できる
4. データ量に応じて方法を選択する

### 次のステップ

次のレッスンでは、モデルの評価方法について詳しく学びます。

---

更新日: 2025年12月

