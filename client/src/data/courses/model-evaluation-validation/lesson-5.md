# 交差検証の実践

## このレッスンで学ぶこと

このレッスンを完了すると、交差検証の方法を理解し、実践的に活用できるようになります。
限られたデータで信頼性の高い評価を行う方法を習得します。

---

## セクション1: 交差検証とは何か

### 交差検証の定義

交差検証は、データを複数のグループに分割し、それぞれで訓練と評価を繰り返す手法です。

目的：
- データを有効活用
- より信頼性の高い評価
- 過学習の検出

### なぜ重要なのか

限られたデータで、信頼性の高い評価を行うために重要です。

- データを最大限に活用
- 偏りのない評価
- 汎化性能の評価

---

## セクション2: k-fold交差検証

### k-fold交差検証の手順

1. データをk個のグループに分割
2. k-1個を訓練、1個を検証として使用
3. k回繰り返す
4. 各foldでの性能を計算
5. 平均性能を計算

### kの選択

kの値は、データサイズに応じて選択します。

- **k = 5**: 中規模データ
- **k = 10**: 一般的（推奨）
- **Leave-One-Out**: 小規模データ

---

## セクション3: 層化k-fold交差検証

### 層化とは

各グループのクラス分布を保持することです。

重要性：
- 不均衡データで重要
- より公平な評価

### 実装

各foldでクラス分布を保持します。

- 各クラスの割合を維持
- より信頼性の高い評価

---

## セクション4: 時系列データの交差検証

### 時系列データの特殊性

時系列データでは、通常の交差検証は適切でない場合があります。

問題：
- 時間的な依存関係
- 未来のデータで過去を予測できない

### Time Series Cross-Validation

時間的な順序を考慮した交差検証です。

手順：
1. 時系列順にデータを分割
2. 過去のデータで訓練、未来のデータで評価
3. 時間を進めながら繰り返す

---

## セクション5: 実践例

### 例：画像診断モデル

10-fold交差検証を実施：

1. データを10個のグループに分割
2. 各foldで訓練と評価
3. 10回の結果の平均を計算
4. 標準偏差も計算して信頼性を評価

結果：
- 平均AUC: 0.92
- 標準偏差: 0.02
- 信頼性の高い評価

### 例：予測モデル

5-fold交差検証を実施：

1. データを5個のグループに分割
2. 層化を実施（クラス分布を保持）
3. 各foldで訓練と評価
4. 5回の結果の平均を計算

---

## まとめ：交差検証の実践を理解する

このレッスンでは、交差検証の実践方法を学びました。

重要なポイント：
1. 交差検証はデータを有効活用する手法
2. k-fold交差検証が一般的
3. 不均衡データでは層化が重要
4. 時系列データでは時間的順序を考慮
5. 実践的に活用して信頼性の高い評価

### 次のステップ

次のレッスンでは、外部検証について詳しく学びます。

---

更新日: 2025年12月

