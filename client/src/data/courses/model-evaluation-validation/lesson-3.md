# 回帰モデルの評価指標

## このレッスンで学ぶこと

このレッスンを完了すると、回帰モデルの評価指標を理解し、適切な指標を選択できるようになります。
医療AIでの回帰タスク（予測値の推定）の評価方法を習得します。

---

## セクション1: 回帰モデルとは

### 回帰モデルの定義

回帰モデルは、連続値を予測するモデルです。

医療での例：
- 血圧の予測
- 血糖値の予測
- 生存期間の予測
- 薬物投与量の予測

### 分類との違い

- **分類**: カテゴリを予測（疾患の有無など）
- **回帰**: 連続値を予測（検査値など）

---

## セクション2: 基本的な評価指標

### 平均二乗誤差（MSE）

予測値と実際の値の差の二乗の平均です。

公式：
```
MSE = Σ(予測値 - 実際の値)² / n
```

特徴：
- 大きな誤差を重視
- 単位が元の値の二乗

### 平均絶対誤差（MAE）

予測値と実際の値の差の絶対値の平均です。

公式：
```
MAE = Σ|予測値 - 実際の値| / n
```

特徴：
- すべての誤差を等しく扱う
- 単位が元の値と同じ

### 二乗平均平方根誤差（RMSE）

MSEの平方根です。

公式：
```
RMSE = √MSE
```

特徴：
- MSEと同様に大きな誤差を重視
- 単位が元の値と同じ

---

## セクション3: 決定係数（R²）

### R²とは

決定係数は、モデルがデータをどの程度説明できるかを表します。

公式：
```
R² = 1 - (残差の平方和) / (総平方和)
```

範囲：
- 0から1の値
- 1に近いほど良い

解釈：
- **R² = 0.8**: 説明変数が目的変数の80%を説明
- **R² = 0.3**: 説明変数が目的変数の30%を説明

### 調整済みR²

変数の数を考慮したR²です。

特徴：
- 変数が増えるとR²が上がる問題を補正
- より公平な評価

---

## セクション4: 医療での評価の注意点

### 臨床的な意味

統計的な指標だけでなく、臨床的な意味を考慮します。

例：
- 血圧の予測誤差が5mmHg → 臨床的に許容可能
- 血圧の予測誤差が20mmHg → 臨床的に問題

### 誤差の分布

誤差の分布を確認します。

- 正規分布に従っているか
- 外れ値がないか
- 系統的な誤差がないか

---

## セクション5: 実践例

### 例：血圧の予測

- **MSE**: 25 mmHg²
- **RMSE**: 5 mmHg
- **MAE**: 4 mmHg
- **R²**: 0.75

解釈：
- RMSEが5mmHg → 臨床的に許容可能
- R²が0.75 → 良好な説明力

### 例：生存期間の予測

- **MSE**: 100 日²
- **RMSE**: 10 日
- **MAE**: 8 日
- **R²**: 0.65

解釈：
- RMSEが10日 → 用途によって評価が異なる
- R²が0.65 → 中程度の説明力

---

## まとめ：回帰モデルの評価指標を理解する

このレッスンでは、回帰モデルの評価指標を学びました。

重要なポイント：
1. MSE、MAE、RMSEが基本的な指標
2. R²でモデルの説明力を評価
3. 臨床的な意味を考慮する
4. 誤差の分布を確認する
5. 用途に応じて適切な指標を選択

### 次のステップ

次のレッスンでは、過学習の検出と対策について詳しく学びます。

---

更新日: 2025年12月

