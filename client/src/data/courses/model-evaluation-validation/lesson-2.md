# 分類モデルの評価指標

## このレッスンで学ぶこと

このレッスンを完了すると、分類モデルの評価指標を理解し、適切な指標を選択できるようになります。
医療AIでの分類タスクの評価方法を習得します。

---

## セクション1: 混同行列

### 混同行列とは

混同行列は、予測結果と正解を比較する表です。

構成：
- **True Positive (TP)**: 正しく陽性と予測
- **True Negative (TN)**: 正しく陰性と予測
- **False Positive (FP)**: 誤って陽性と予測（偽陽性）
- **False Negative (FN)**: 誤って陰性と予測（偽陰性）

### 医療での重要性

混同行列は、医療AIの評価の基礎です。

- どのような誤りが多いか理解
- 改善の指針を得る

---

## セクション2: 基本的な評価指標

### 精度（Accuracy）

全体のうち、正しく予測した割合です。

公式：
```
精度 = (TP + TN) / (TP + TN + FP + FN)
```

特徴：
- 直感的で理解しやすい
- 不均衡データでは適切でない場合がある

### 感度（Sensitivity / Recall）

実際に陽性のうち、正しく陽性と予測した割合です。

公式：
```
感度 = TP / (TP + FN)
```

医療での意味：
- 病気を見逃さない能力
- 見逃してはいけない疾患では重要

### 特異度（Specificity）

実際に陰性のうち、正しく陰性と予測した割合です。

公式：
```
特異度 = TN / (TN + FP)
```

医療での意味：
- 正常を正しく判断する能力
- 不要な検査や治療を避けるために重要

### 適合率（Precision）

陽性と予測したうち、実際に陽性だった割合です。

公式：
```
適合率 = TP / (TP + FP)
```

医療での意味：
- 陽性と判断した場合の信頼性

---

## セクション3: F1スコア

### F1スコアとは

感度と適合率の調和平均です。

公式：
```
F1 = 2 × (感度 × 適合率) / (感度 + 適合率)
```

特徴：
- 感度と適合率のバランスを評価
- 不均衡データで有用

### 用途

F1スコアは、以下の場合に有用です：

- 感度と適合率の両方が重要
- 不均衡データ
- 単一の指標で評価したい場合

---

## セクション4: ROC曲線とAUC

### ROC曲線

ROC曲線は、感度と1-特異度の関係を表す曲線です。

特徴：
- X軸: 1-特異度（偽陽性率）
- Y軸: 感度（真陽性率）
- 閾値を変化させて描画

解釈：
- 左上に近いほど良い
- 対角線に近いほど悪い

### AUC

AUCは、ROC曲線の下の面積です。

範囲：
- 0.5: ランダムな予測
- 1.0: 完璧な予測

解釈：
- **0.9以上**: 優れた性能
- **0.7-0.9**: 良好な性能
- **0.7未満**: 改善が必要

---

## セクション5: 医療AIでの指標の選択

### 用途に応じた選択

用途に応じて、重視する指標を選択します。

#### スクリーニング

- **重視**: 感度（見逃しを防ぐ）
- **許容**: 特異度が低くても良い場合がある

#### 確定診断

- **重視**: 適合率（陽性判断の信頼性）
- **許容**: 感度が低くても良い場合がある

#### バランス重視

- **重視**: F1スコア、AUC
- **両方**: 感度と特異度のバランス

---

## まとめ：分類モデルの評価指標を理解する

このレッスンでは、分類モデルの評価指標を学びました。

重要なポイント：
1. 混同行列が評価の基礎
2. 精度、感度、特異度、適合率が基本的な指標
3. F1スコアで感度と適合率のバランスを評価
4. ROC曲線とAUCで全体的な性能を評価
5. 用途に応じて適切な指標を選択

### 次のステップ

次のレッスンでは、回帰モデルの評価指標について詳しく学びます。

---

更新日: 2025年12月

