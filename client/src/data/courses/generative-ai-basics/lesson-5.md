# トークン化とコンテキストウィンドウ

## 🎯 このレッスンで学ぶこと

このレッスンを完了すると、トークン化の仕組みとコンテキストウィンドウの概念を理解し、生成AIがテキストをどのように処理するかを把握できるようになります。医療文書での実践的な影響も学びます。

---

## 📖 セクション1: トークン化とは何か

### テキストの分割

トークン化（Tokenization）は、テキストを小さな単位（トークン）に分割する処理です。AIは、テキストを直接理解するのではなく、トークンという単位で処理します。

**トークンの種類**：
- **単語単位**：各単語が1つのトークン（例：「患者」「診断」）
- **部分単語単位**：単語をさらに小さく分割（例：「診断」→「診」「断」）
- **文字単位**：各文字が1つのトークン（あまり使われない）

### 医療用語のトークン化

医療用語は、一般的な単語よりも長く、複雑な場合があります。

**例**：
- 「急性心筋梗塞」→ 複数のトークンに分割される可能性
- 「2型糖尿病」→ 「2」「型」「糖尿病」などに分割

**重要な理解**：
トークン化の方法によって、AIの理解が変わる可能性があります。医療用語を適切にトークン化することは、正確な理解に重要です。

---

## 📖 セクション2: コンテキストウィンドウ

### 一度に処理できる情報量

コンテキストウィンドウは、AIが一度に処理できるトークン数の上限です。

**コンテキストウィンドウのサイズ**：
- **GPT-3.5**：約4,000トークン
- **GPT-4**：約8,000〜32,000トークン（モデルによって異なる）
- **Claude 3**：約200,000トークン
- **Gemini**：約1,000,000トークン

### 医療文書での影響

医療文書は、しばしば長くなります。症例報告書や診療記録は、数千から数万トークンになる場合があります。

**実践的な影響**：
- **長い文書の処理**：コンテキストウィンドウを超える場合は、分割が必要
- **情報の優先順位**：重要な情報を最初に配置する
- **要約の活用**：長い文書を要約してから処理

---

## 📖 セクション3: トークン数の見積もり

### 日本語と英語の違い

日本語と英語では、トークン化の方法が異なります。

**一般的な目安**：
- **英語**：1単語 ≈ 1.3トークン
- **日本語**：1文字 ≈ 0.5〜1トークン（文字の種類による）

**医療文書での例**：
- 短い診断書（500文字）≈ 250〜500トークン
- 症例報告書（5,000文字）≈ 2,500〜5,000トークン
- 長い診療記録（20,000文字）≈ 10,000〜20,000トークン

### トークン数の確認方法

多くのAIツールでは、トークン数を確認できます。

**確認方法**：
- **ChatGPT**：入力テキストの文字数から概算
- **Claude**：トークン数を表示
- **API**：トークン数を正確に計算

---

## 📖 セクション4: コンテキストウィンドウの最適化

### 効率的な情報の配置

コンテキストウィンドウを効率的に使うためには、情報の配置が重要です。

**ベストプラクティス**：
- **重要な情報を最初に**：診断名、主訴など、重要な情報を最初に配置
- **不要な情報の削除**：冗長な情報は削除
- **構造化**：情報を構造化して、理解しやすくする

### 長い文書の処理

コンテキストウィンドウを超える長い文書を処理する場合の方法：

**方法1：分割**：
- 文書を複数の部分に分割
- 各部分を個別に処理
- 結果を統合

**方法2：要約**：
- 長い文書を要約
- 要約版を処理
- 必要に応じて詳細を参照

**方法3：重要な部分の抽出**：
- 重要な部分のみを抽出
- 抽出した部分を処理

---

## 💡 重要な洞察：コンテキストの重要性

コンテキストウィンドウは、AIの能力を大きく左右します。大きなコンテキストウィンドウを持つAIは、より長い文書を理解し、より一貫性のある出力を生成できます。

**医療現場での重要性**：
- **診療記録の理解**：長い診療記録を一度に処理できる
- **一貫性の維持**：文書全体の一貫性を保てる
- **詳細な分析**：より詳細な分析が可能

---

## 🎓 まとめ：トークン化とコンテキストウィンドウを理解する

このレッスンでは、トークン化とコンテキストウィンドウについて学びました。

**重要なポイント**：

1. **トークン化**：テキストを小さな単位に分割する処理
2. **コンテキストウィンドウ**：一度に処理できるトークン数の上限
3. **医療文書での影響**：長い文書の処理方法を理解
4. **最適化**：効率的な情報の配置と処理方法

### 次のステップ

次のレッスンでは、生成プロセスとサンプリングについて学びます。AIがどのようにテキストを生成するかを理解します。

---

**更新日**: 2025年1月
