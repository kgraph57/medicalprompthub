# 外れ値の検出と処理

## このレッスンで学ぶこと

このレッスンでは、外れ値の検出方法と処理方法を学びます。
医療データにおける外れ値の意味を理解し、適切な処理を選択できるようになります。

---

## セクション1: 外れ値とは何か

### 外れ値の定義

外れ値とは、データセットの他の値と大きく異なる値のことです。

医療データでの外れ値の例：
- 異常に高い/低い検査値
- 測定エラー
- データ入力ミス
- 真の異常値（重要な臨床情報）

### 外れ値の影響

外れ値は、AIモデルの性能に大きな影響を与えます。

影響：
- モデルの学習を妨げる
- 予測精度の低下
- 統計量の歪み
- 誤った結論の導出

---

## セクション2: 外れ値の検出方法

### 方法1: 統計的手法

#### Zスコア法

平均から標準偏差の何倍離れているかを計算します。

- Zスコア > 3 または < -3 → 外れ値の可能性

適用条件：
- データが正規分布に従う場合
- 外れ値が少ない場合

#### IQR（四分位範囲）法

四分位範囲（IQR）を使用して外れ値を検出します。

- Q1 - 1.5×IQR より小さい値
- Q3 + 1.5×IQR より大きい値

適用条件：
- データの分布が不明な場合
- ロバストな検出が必要な場合

### 方法2: 可視化による検出

#### ボックスプロット

ボックスプロットで外れ値を視覚的に確認します。

- 箱の外側の点が外れ値

#### 散布図

散布図で外れ値を視覚的に確認します。

- 他の点から大きく離れた点

### 方法3: 機械学習による検出

#### 孤立フォレスト（Isolation Forest）

異常検出アルゴリズムを使用します。

- 外れ値を自動的に検出
- 複数変数の組み合わせに対応

#### DBSCAN

クラスタリングアルゴリズムを使用します。

- 密度の低い領域を外れ値として検出

---

## セクション3: 医療データでの外れ値の意味

### 真の異常値

外れ値が、真の異常値（重要な臨床情報）である場合があります。

例：
- 極端に高い血糖値 → 糖尿病の可能性
- 異常に低い血圧 → ショックの可能性

処理：
- **削除しない**: 重要な臨床情報として扱う
- **専門家と相談**: 臨床的な意味を確認

### 測定エラー

外れ値が、測定エラーである場合があります。

例：
- 機器の故障
- 測定条件の不備
- データ入力ミス

処理：
- **削除または修正**: エラーとして扱う
- **再測定**: 可能であれば再測定

---

## セクション4: 外れ値の処理方法

### 方法1: 削除

外れ値をデータセットから削除します。

適用条件：
- 測定エラーであることが確実
- 外れ値が少数
- 削除しても分析に影響がない

注意点：
- 真の異常値を削除しない
- 削除の理由を記録

### 方法2: 修正

外れ値を適切な値に修正します。

適用条件：
- 測定エラーであることが確実
- 正しい値が推定可能

方法：
- 平均値・中央値で置換
- 前後の値から補間
- 専門家の判断を参考

### 方法3: 変換

データを変換して外れ値の影響を軽減します。

方法：
- 対数変換
- 平方根変換
- Box-Cox変換

適用条件：
- 外れ値が多数
- 分布の歪みが大きい

### 方法4: 保持

外れ値をそのまま保持します。

適用条件：
- 真の異常値である可能性が高い
- 重要な臨床情報

注意点：
- モデルの選択を考慮
- ロバストな手法を使用

---

## セクション5: 実践例

### 例1: 血液検査データの外れ値処理

血液検査データでは、以下の処理が適切です：

1. **外れ値の検出**
   - IQR法で検出
   - 可視化で確認

2. **意味の確認**
   - 臨床的に妥当か
   - 測定エラーの可能性

3. **処理の選択**
   - 真の異常値 → 保持
   - 測定エラー → 削除または修正

### 例2: バイタルサインの外れ値処理

バイタルサインでは、以下の処理が適切です：

1. **時系列データの考慮**
   - 前後の値と比較
   - 時間的な傾向を考慮

2. **臨床的な妥当性**
   - 生理学的に可能な値か
   - 専門家の意見を聞く

---

## まとめ：外れ値の検出と処理を理解する

このレッスンでは、外れ値の検出方法と処理方法を学びました。

重要なポイント：
1. 外れ値には真の異常値と測定エラーがある
2. 検出方法には統計的手法、可視化、機械学習がある
3. 医療データでは臨床的な意味を考慮する
4. 処理方法は外れ値の意味に応じて選択する

### 次のステップ

次のレッスンでは、データの正規化と標準化について詳しく学びます。

---

更新日: 2025年12月

