## データ準備とAIによる初期チェック

### 1. 統計解析のためのデータ構造化

AIに統計解析の相談をする前に、データセットを「Tidy Data（整然データ）」の原則に従って構造化することが重要です。これにより、AIがデータの意図を正確に理解し、適切なコードやアドバイスを生成できるようになります。

| Tidy Dataの原則 | 説明 | 医療データでの具体例 |
| :--- | :--- | :--- |
| 各変数は列 | 測定したい各属性（変数）は、データセットの1つの列になる。 | 年齢、性別、診断名、投与量、検査値など。 |
| 各観測値は行 | 測定の単位（観測値）は、データセットの1つの行になる。 | 一人の患者のデータ、一回の入院記録、一回の外来受診記録など。 |
| 各観測単位は表 | 複数の観測単位がある場合は、それぞれ独立した表にする。 | 患者基本情報、検査結果推移、投薬履歴など。 |

### 2. 実用的なプロンプト例：データ構造の確認とクリーニング

AIは、データセットのメタデータ（列名、データ型、簡単な統計量）を与えることで、データクリーニングや前処理のアイデアを提案できます。

プロンプト例 1: データ構造の確認と改善提案

```
以下のデータセットのメタデータ（列名、データ型、最初の5行のデータ）を確認してください。
このデータは、ある疾患の治療効果を評価するためのものです。
特に、統計解析を行う上で、データ型や欠損値の扱いに関して問題点や改善すべき点があれば指摘し、その処理方針を提案してください。

[データメタデータ例]
- patient_id: int (ユニークID)
- age: int (年齢、範囲: 20-90)
- sex: object (性別、値: 'Male', 'Female', 'Other')
- treatment_group: object (治療群、値: 'A', 'B', 'Control')
- outcome_score: float (主要評価項目、範囲: 0-100、欠損値あり)
- hospital_stay_days: int (入院日数、範囲: 1-60、外れ値の可能性あり)
```

プロンプト例 2: 欠損値処理の戦略に関する相談

```
データセットの主要評価項目である「outcome_score」に約15%の欠損値（NA）があります。
この欠損は、ランダムではない可能性（MAR: Missing At Random）が疑われます。
この状況で、統計的バイアスを最小限に抑えるための欠損値補完（Imputation）戦略として、多重代入法（Multiple Imputation）の適用を検討しています。
多重代入法を適用する際の注意点と、Python (MICE) または R (mice) での具体的な実装手順の概要を教えてください。
```

### 3. 注意点とTips：AIの提案を統計的根拠で裏付ける

*   データ型の一貫性: カテゴリ変数（例：性別、治療群）が文字列（object）として扱われている場合、AIにダミー変数化や順序付けの提案を求めることができます。
*   外れ値の特定: AIに「箱ひげ図の作成コード」や「Zスコアによる外れ値の特定コード」を生成させ、外れ値のリストを出力させます。そのリストを基に、臨床的な観点から外れ値の妥当性を判断してください。
*   AIは統計的根拠を提示しない: AIは処理方法を提案しますが、その処理がなぜ適切なのかという統計的根拠を深く理解するのはユーザーの責任です。提案された手法の背景にある統計学的な理論を、別途学習することが望ましいです。

### 次のステップへ

データ準備と初期チェックが完了したら、いよいよ具体的な統計解析の計画と実行に移ります。
→ [02-practice/step-01.md: 統計解析計画（SAP）の作成支援] へ進む
